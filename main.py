import time
import random
from web3 import Web3
from eth_account import Account

# ABI контракта
abi = [{"inputs":[{"components":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"},{"internalType":"uint40","name":"maximumNumberOfParticipantsPerRound","type":"uint40"},{"internalType":"uint40","name":"roundDuration","type":"uint40"},{"internalType":"uint96","name":"valuePerEntry","type":"uint96"},{"internalType":"address","name":"protocolFeeRecipient","type":"address"},{"internalType":"uint16","name":"protocolFeeBp","type":"uint16"},{"internalType":"uint16","name":"discountedProtocolFeeBp","type":"uint16"},{"internalType":"bytes32","name":"keyHash","type":"bytes32"},{"internalType":"uint64","name":"subscriptionId","type":"uint64"},{"internalType":"address","name":"vrfCoordinator","type":"address"},{"internalType":"address","name":"reservoirOracle","type":"address"},{"internalType":"address","name":"transferManager","type":"address"},{"internalType":"address","name":"erc20Oracle","type":"address"},{"internalType":"address","name":"weth","type":"address"},{"internalType":"uint40","name":"signatureValidityPeriod","type":"uint40"},{"internalType":"uint16","name":"minimumRequestConfirmations","type":"uint16"}],"internalType":"struct IYoloV2.ConstructorCalldata","name":"params","type":"tuple"},{"internalType":"address","name":"_ethYieldConfiguration","type":"address"},{"internalType":"address","name":"_usdbYieldConfiguration","type":"address"},{"internalType":"address","name":"_blastPoints","type":"address"},{"internalType":"address","name":"_blastPointsOperator","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"AlreadyWithdrawn","type":"error"},{"inputs":[],"name":"CutoffTimeNotReached","type":"error"},{"inputs":[],"name":"DrawExpirationTimeNotReached","type":"error"},{"inputs":[],"name":"ERC20TransferFail","type":"error"},{"inputs":[],"name":"ERC721TransferFromFail","type":"error"},{"inputs":[],"name":"ExceededMaximumDepositAmountPerRound","type":"error"},{"inputs":[],"name":"InsufficientParticipants","type":"error"},{"inputs":[],"name":"InvalidIndex","type":"error"},{"inputs":[],"name":"InvalidLength","type":"error"},{"inputs":[],"name":"InvalidSignatureTimestamp","type":"error"},{"inputs":[],"name":"InvalidStatus","type":"error"},{"inputs":[],"name":"InvalidToken","type":"error"},{"inputs":[],"name":"InvalidTokenType","type":"error"},{"inputs":[],"name":"InvalidValue","type":"error"},{"inputs":[],"name":"IsPaused","type":"error"},{"inputs":[],"name":"LooksAlreadySet","type":"error"},{"inputs":[],"name":"MaximumNumberOfDepositsReached","type":"error"},{"inputs":[],"name":"MaximumNumberOfParticipantsReached","type":"error"},{"inputs":[],"name":"MessageIdInvalid","type":"error"},{"inputs":[],"name":"NotAContract","type":"error"},{"inputs":[],"name":"NotDepositor","type":"error"},{"inputs":[],"name":"NotOperator","type":"error"},{"inputs":[],"name":"NotOwner","type":"error"},{"inputs":[],"name":"NotPaused","type":"error"},{"inputs":[],"name":"NotWinner","type":"error"},{"inputs":[],"name":"NullSignerAddress","type":"error"},{"inputs":[],"name":"OnePlayerCannotFillUpTheWholeRound","type":"error"},{"inputs":[{"internalType":"address","name":"have","type":"address"},{"internalType":"address","name":"want","type":"address"}],"name":"OnlyCoordinatorCanFulfill","type":"error"},{"inputs":[],"name":"OutflowNotAllowed","type":"error"},{"inputs":[],"name":"ProtocolFeeNotPaid","type":"error"},{"inputs":[],"name":"RandomnessRequestAlreadyExists","type":"error"},{"inputs":[],"name":"ReentrancyFail","type":"error"},{"inputs":[],"name":"RoundCannotBeClosed","type":"error"},{"inputs":[],"name":"SignatureEOAInvalid","type":"error"},{"inputs":[],"name":"SignatureERC1271Invalid","type":"error"},{"inputs":[{"internalType":"uint256","name":"length","type":"uint256"}],"name":"SignatureLengthInvalid","type":"error"},{"inputs":[],"name":"SignatureParameterSInvalid","type":"error"},{"inputs":[{"internalType":"uint8","name":"v","type":"uint8"}],"name":"SignatureParameterVInvalid","type":"error"},{"inputs":[],"name":"TooFewEntries","type":"error"},{"inputs":[],"name":"ZeroDeposits","type":"error"},{"inputs":[],"name":"ZeroEntries","type":"error"},{"inputs":[],"name":"ZeroRounds","type":"error"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"depositor","type":"address"},{"indexed":False,"internalType":"uint256","name":"roundId","type":"uint256"},{"indexed":False,"internalType":"uint256","name":"entriesCount","type":"uint256"}],"name":"Deposited","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"depositor","type":"address"},{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"indexed":False,"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"}],"name":"DepositsWithdrawn","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint16","name":"discountedProtocolFeeBp","type":"uint16"}],"name":"DiscountedProtocolFeeBpUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"erc20Oracle","type":"address"}],"name":"ERC20OracleUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"maximumDepositAmountPerRound","type":"uint256"}],"name":"MaximumDepositAmountPerRoundUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint40","name":"maximumNumberOfParticipantsPerRound","type":"uint40"}],"name":"MaximumNumberOfParticipantsPerRoundUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"depositor","type":"address"},{"indexed":False,"internalType":"uint256","name":"startingRoundId","type":"uint256"},{"indexed":False,"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"indexed":False,"internalType":"uint256[]","name":"entriesCounts","type":"uint256[]"}],"name":"MultipleRoundsDeposited","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"bool","name":"isAllowed","type":"bool"}],"name":"OutflowAllowedUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"account","type":"address"}],"name":"Paused","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"winner","type":"address"},{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"indexed":False,"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"}],"name":"PrizesClaimed","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint16","name":"protocolFeeBp","type":"uint16"}],"name":"ProtocolFeeBpUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":False,"internalType":"address","name":"token","type":"address"}],"name":"ProtocolFeePayment","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"protocolFeeRecipient","type":"address"}],"name":"ProtocolFeeRecipientUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"roundId","type":"uint256"},{"indexed":False,"internalType":"uint256","name":"requestId","type":"uint256"}],"name":"RandomnessRequested","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"reservoirOracle","type":"address"}],"name":"ReservoirOracleUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":True,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":True,"internalType":"bytes32","name":"previousAdminRole","type":"bytes32"},{"indexed":True,"internalType":"bytes32","name":"newAdminRole","type":"bytes32"}],"name":"RoleAdminChanged","type":"event"},{"anonymous":False,"inputs":[{"indexed":True,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":True,"internalType":"address","name":"account","type":"address"},{"indexed":True,"internalType":"address","name":"sender","type":"address"}],"name":"RoleGranted","type":"event"},{"anonymous":False,"inputs":[{"indexed":True,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":True,"internalType":"address","name":"account","type":"address"},{"indexed":True,"internalType":"address","name":"sender","type":"address"}],"name":"RoleRevoked","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"depositor","type":"address"},{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"indexed":False,"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"},{"indexed":False,"internalType":"uint256","name":"enteredRoundId","type":"uint256"},{"indexed":False,"internalType":"uint256","name":"entriesCount","type":"uint256"}],"name":"Rollover","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint40","name":"roundDuration","type":"uint40"}],"name":"RoundDurationUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"roundId","type":"uint256"},{"indexed":False,"internalType":"enum IYoloV2.RoundStatus","name":"status","type":"uint8"}],"name":"RoundStatusUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"startingRoundId","type":"uint256"},{"indexed":False,"internalType":"uint256","name":"numberOfRounds","type":"uint256"}],"name":"RoundsCancelled","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint40","name":"signatureValidityPeriod","type":"uint40"}],"name":"SignatureValidityPeriodUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address[]","name":"tokens","type":"address[]"},{"indexed":False,"internalType":"enum IYoloV2.YoloV2__TokenType","name":"tokenType","type":"uint8"},{"indexed":False,"internalType":"bool","name":"isAllowed","type":"bool"}],"name":"TokensStatusUpdated","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"address","name":"account","type":"address"}],"name":"Unpaused","type":"event"},{"anonymous":False,"inputs":[{"indexed":False,"internalType":"uint256","name":"valuePerEntry","type":"uint256"}],"name":"ValuePerEntryUpdated","type":"event"},{"inputs":[],"name":"DEFAULT_ADMIN_ROLE","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"numberOfRounds","type":"uint256"}],"name":"cancel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"cancel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"cancelAfterRandomnessRequest","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"wethReceiver","type":"address"},{"internalType":"address","name":"usdbReceiver","type":"address"}],"name":"claim","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"},{"internalType":"bool","name":"payWithLOOKS","type":"bool"}],"name":"claimPrizes","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"components":[{"internalType":"enum IYoloV2.YoloV2__TokenType","name":"tokenType","type":"uint8"},{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"uint256[]","name":"tokenIdsOrAmounts","type":"uint256[]"},{"internalType":"uint256","name":"minimumEntries","type":"uint256"},{"components":[{"internalType":"bytes32","name":"id","type":"bytes32"},{"internalType":"bytes","name":"payload","type":"bytes"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bytes","name":"signature","type":"bytes"}],"internalType":"struct IYoloV2.ReservoirOracleFloorPrice","name":"reservoirOracleFloorPrice","type":"tuple"}],"internalType":"struct IYoloV2.DepositCalldata[]","name":"deposits","type":"tuple[]"}],"name":"deposit","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"address","name":"depositor","type":"address"}],"name":"depositCount","outputs":[{"internalType":"uint256","name":"depositCount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"startingRoundId","type":"uint256"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"}],"name":"depositETHIntoMultipleRounds","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"address","name":"depositor","type":"address"}],"name":"depositedAmount","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"discountedProtocolFeeBp","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"drawWinner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"erc20Oracle","outputs":[{"internalType":"contract IPriceOracle","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"components":[{"internalType":"enum IYoloV2.YoloV2__TokenType","name":"tokenType","type":"uint8"},{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"uint256[]","name":"tokenIdsOrAmounts","type":"uint256[]"},{"internalType":"uint256","name":"minimumEntries","type":"uint256"},{"components":[{"internalType":"bytes32","name":"id","type":"bytes32"},{"internalType":"bytes","name":"payload","type":"bytes"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"bytes","name":"signature","type":"bytes"}],"internalType":"struct IYoloV2.ReservoirOracleFloorPrice","name":"reservoirOracleFloorPrice","type":"tuple"}],"internalType":"struct IYoloV2.DepositCalldata","name":"singleDeposit","type":"tuple"}],"name":"estimatedERC20DepositEntriesCount","outputs":[{"internalType":"uint256","name":"entriesCount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"},{"internalType":"bool","name":"payWithLOOKS","type":"bool"}],"name":"getClaimPrizesPaymentRequired","outputs":[{"internalType":"uint256","name":"protocolFeeOwed","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"}],"name":"getRoleAdmin","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"}],"name":"getRound","outputs":[{"internalType":"enum IYoloV2.RoundStatus","name":"status","type":"uint8"},{"internalType":"uint40","name":"maximumNumberOfParticipants","type":"uint40"},{"internalType":"uint16","name":"roundProtocolFeeBp","type":"uint16"},{"internalType":"uint40","name":"cutoffTime","type":"uint40"},{"internalType":"uint40","name":"drawnAt","type":"uint40"},{"internalType":"uint40","name":"numberOfParticipants","type":"uint40"},{"internalType":"address","name":"winner","type":"address"},{"internalType":"uint96","name":"roundValuePerEntry","type":"uint96"},{"internalType":"uint256","name":"protocolFeeOwed","type":"uint256"},{"components":[{"internalType":"enum IYoloV2.YoloV2__TokenType","name":"tokenType","type":"uint8"},{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"tokenAmount","type":"uint256"},{"internalType":"address","name":"depositor","type":"address"},{"internalType":"bool","name":"withdrawn","type":"bool"},{"internalType":"uint40","name":"currentEntryIndex","type":"uint40"}],"internalType":"struct IYoloV2.Deposit[]","name":"deposits","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"grantRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"hasRole","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maximumDepositAmountPerRound","outputs":[{"internalType":"uint96","name":"","type":"uint96"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maximumNumberOfParticipantsPerRound","outputs":[{"internalType":"uint40","name":"","type":"uint40"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"outflowAllowed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"paused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenOrCollection","type":"address"},{"internalType":"uint256","name":"roundId","type":"uint256"}],"name":"prices","outputs":[{"internalType":"uint256","name":"price","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"protocolFeeBp","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"requestId","type":"uint256"}],"name":"randomnessRequests","outputs":[{"internalType":"bool","name":"exists","type":"bool"},{"internalType":"uint40","name":"roundId","type":"uint40"},{"internalType":"uint256","name":"randomWord","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"requestId","type":"uint256"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"rawFulfillRandomWords","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"renounceRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"reservoirOracle","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"revokeRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"},{"internalType":"bool","name":"payWithLOOKS","type":"bool"}],"name":"rolloverETH","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"roundDuration","outputs":[{"internalType":"uint40","name":"","type":"uint40"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"roundsCount","outputs":[{"internalType":"uint40","name":"","type":"uint40"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"looks","type":"address"}],"name":"setLOOKS","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"signatureValidityPeriod","outputs":[{"internalType":"uint40","name":"","type":"uint40"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"toggleOutflowAllowed","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"togglePaused","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"_discountedProtocolFeeBp","type":"uint16"}],"name":"updateDiscountedProtocolFeeBp","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_erc20Oracle","type":"address"}],"name":"updateERC20Oracle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint96","name":"_maximumDepositAmountPerRound","type":"uint96"}],"name":"updateMaximumDepositAmountPerRound","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint40","name":"_maximumNumberOfParticipantsPerRound","type":"uint40"}],"name":"updateMaximumNumberOfParticipantsPerRound","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"_protocolFeeBp","type":"uint16"}],"name":"updateProtocolFeeBp","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_protocolFeeRecipient","type":"address"}],"name":"updateProtocolFeeRecipient","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_reservoirOracle","type":"address"}],"name":"updateReservoirOracle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint40","name":"_roundDuration","type":"uint40"}],"name":"updateRoundDuration","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint40","name":"_signatureValidityPeriod","type":"uint40"}],"name":"updateSignatureValidityPeriod","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"tokens","type":"address[]"},{"internalType":"enum IYoloV2.YoloV2__TokenType","name":"tokenType","type":"uint8"},{"internalType":"bool","name":"isAllowed","type":"bool"}],"name":"updateTokensStatus","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint96","name":"_valuePerEntry","type":"uint96"}],"name":"updateValuePerEntry","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"valuePerEntry","outputs":[{"internalType":"uint96","name":"","type":"uint96"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"roundId","type":"uint256"},{"internalType":"uint256[]","name":"depositIndices","type":"uint256[]"}],"internalType":"struct IYoloV2.WithdrawalCalldata[]","name":"withdrawalCalldata","type":"tuple[]"}],"name":"withdrawDeposits","outputs":[],"stateMutability":"nonpayable","type":"function"}]


# Адрес контракта
contract_address = '0x28EF3eaE1AbB6D6e22e9bFc7a0944f707E4726b3'

# Адрес узла Ethereum
w3 = Web3(Web3.HTTPProvider('https://rpc.blast.io'))

# Функция для генерации случайного лимита газа
def get_random_gas_limit(min_gas, max_gas):
    return random.randint(min_gas, max_gas)

# Функция для чтения приватных ключей из файла
def read_private_keys(filename):
    with open(filename, 'r') as file:
        private_keys = file.readlines()
    return [key.strip() for key in private_keys]

# Приватные ключи аккаунтов
private_keys = read_private_keys('private_keys.txt')

# Перемешиваем приватные ключи
random.shuffle(private_keys)

# Создание экземпляра контракта
contract = w3.eth.contract(address=contract_address, abi=abi)


# Создание транзакции для каждого аккаунта
successful_accounts = []  # Список для успешно выполненных кошельков


# Создание транзакции для каждого аккаунта
for private_key in private_keys:
    account = Account.from_key(private_key)
    nonce = w3.eth.get_transaction_count(account.address)
    tx = contract.functions.cancel().build_transaction({
        'chainId': 81457,  # Идентификатор сети Ethereum
        'gas': get_random_gas_limit(40000, 50000),  # Лимит газа
        'gasPrice': w3.eth.gas_price,  # Цена газа
        'nonce': nonce,  # Нонс
    })
    
    # Подпись и отправка транзакции
    signed_tx = w3.eth.account.sign_transaction(tx, private_key)
    tx_hash = w3.eth.send_raw_transaction(signed_tx.rawTransaction)
    
    # Ожидание подтверждения транзакции
    receipt = w3.eth.wait_for_transaction_receipt(tx_hash)
    print(f"Транзакция от аккаунта {account.address} успешно отправлена и подтверждена. Hash: {tx_hash.hex()}")
    
    # Добавление успешно выполненных кошельков в список
    successful_accounts.append(account.address)

    # Пауза на случайное количество секунд от 45 до 150
    random_delay = random.uniform(100, 550)
    rounded_delay = round(random_delay)
    print(f"Ожидаю {rounded_delay} сек. перед следующим аккаунтом")
    time.sleep(rounded_delay)

# Запись успешно выполненных кошельков в файл
with open('successful.txt', 'w') as file:
    for account_address in successful_accounts:
        file.write(f"{account_address}\n")
